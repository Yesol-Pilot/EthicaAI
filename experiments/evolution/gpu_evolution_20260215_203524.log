/mnt/d/00.test/PAPER/EthicaAI/simulation/genesis/theorist.py:5: FutureWarning: 

All support for the `google.generativeai` package has ended. It will no longer be receiving 
updates or bug fixes. Please switch to the `google.genai` package as soon as possible.
See README for more details:

https://github.com/google-gemini/deprecated-generative-ai-python/blob/main/README.md

  import google.generativeai as genai
INFO:root:JAX backend: gpu, Devices: [CudaDevice(id=0)]
ğŸ–¥ï¸ JAX Platform: gpu | Devices: [CudaDevice(id=0)]
============================================================
ğŸ›ï¸  EthicaAI Genesis Lab â€” Autonomous R&D System
   'ì„±ê³µí•˜ë©´ ë” ê¹Šì´, ì‹¤íŒ¨í•˜ë©´ ëŒ€ì•ˆì„'
============================================================

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“‹ ì—°êµ¬ ê³¼ì œ: RQ-009
   ì§ˆë¬¸: ë¹” ë¹„ìš© ë¯¼ê°ë„ì™€ í˜‘ë ¥ì  í–‰ë™ì˜ ë¶„ë¦¬ì— ì´ˆì ì„ ë§ì¶˜ ìë™ ìƒì„± ë‹¨ê³„ë¥¼ ì‚¬ìš©í•˜ëŠ” ì»¤ë¦¬í˜ëŸ¼ í•™ìŠµì´ ìˆ˜ì •ëœ í˜‘ë ¥ì  ë³´ìƒ êµ¬ì¡°(REWARD_APPLE, COST_BEAM)ë¡œ í›ˆë ¨ëœ ì—ì´ì „íŠ¸ì˜ í˜‘ë ¥ë¥ ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆëŠ”ê°€?
   ëª©í‘œ: cooperation_rate > 0.5
   ìœ í˜•: pivot
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ”„ --- [RQ-009] Generation 1 ---
ğŸ§  Theorist is thinking...
ğŸ§  Theorist proposed: {
  "GENESIS_BETA": 0.7,
  "GENESIS_ALPHA": 0.3,
  "GENESIS_LOGIC_MODE": "adaptive_beta",
  "IA_ALPHA": 2.0,
  "IA_BETA": 0.2,
  "USE_INEQUITY_AVERSION": true,
  "rationale": "Reverting to the initial GENESIS parameters while enabling Inequity Aversion with moderate alpha and beta to encourage fairness and cooperation by penalizing agents for excessive reward disparities.",
  "rationale_kr": "\ucd08\uae30 GENESIS \ud30c\ub77c\ubbf8\ud130\ub85c \ub418\ub3cc\ub9ac\uace0, \uc801\uc808\ud55c \uc54c\ud30c \ubc0f \ubca0\ud0c0 \uac12\uc744 \uc0ac\uc6a9\ud558\uc5ec \ubd88\ud3c9\ub4f1 \ud610\uc624\ub97c \ud65c\uc131\ud654\ud558\uc5ec \ubcf4\uc0c1 \ubd88\uade0\ud615\uc774 \uc2ec\ud55c \uc5d0\uc774\uc804\ud2b8\uc5d0\uac8c \ubd88\uc774\uc775\uc744 \uc90c\uc73c\ub85c\uc368 \uacf5\uc815\uc131\uacfc \ud611\ub825\uc744 \uc7a5\ub824\ud569\ub2c8\ub2e4."
}
  > Proposed: Beta=0.7, Alpha=0.3, Mode=adaptive_beta, IA=ON
ğŸ› ï¸ Engineer is running simulation...
ğŸ› ï¸ Engineer: Running simulation with config: {
  "ENV_NAME": "cleanup",
  "NUM_AGENTS": 20,
  "ENV_HEIGHT": 36,
  "ENV_WIDTH": 25,
  "MAX_STEPS": 500,
  "NUM_ENVS": 16,
  "NUM_UPDATES": 300,
  "ROLLOUT_LEN": 128,
  "BATCH_SIZE": 2048,
  "LR": 0.0003,
  "HIDDEN_DIM": 128,
  "GAMMA": 0.99,
  "GAE_LAMBDA": 0.95,
  "CLIP_EPS": 0.2,
  "ENTROPY_COEFF": 0.05,
  "VF_COEFF": 0.5,
  "MAX_GRAD_NORM": 0.5,
  "HRL_NUM_NEEDS": 2,
  "HRL_NUM_TASKS": 2,
  "HRL_ALPHA": 1.0,
  "HRL_THRESH_INCREASE": 0.005,
  "HRL_THRESH_DECREASE": 0.05,
  "HRL_INTAKE_VAL": 0.2,
  "REWARD_APPLE": 10.0,
  "COST_BEAM": -1.0,
  "META_BETA": 0.1,
  "META_SURVIVAL_THRESHOLD": -5.0,
  "META_WEALTH_BOOST": 5.0,
  "META_LAMBDA_EMA": 0.9,
  "USE_META_RANKING": true,
  "META_USE_DYNAMIC_LAMBDA": true,
  "GENESIS_MODE": false,
  "GENESIS_BETA_BASE": 10.0,
  "GENESIS_GAMMA": 2.0,
  "GENESIS_ALPHA": 0.3,
  "DASHBOARD_PORT": 4011,
  "USE_INEQUITY_AVERSION": true,
  "IA_ALPHA": 2.0,
  "IA_BETA": 0.2,
  "IA_EMA_LAMBDA": 0.95,
  "SI_WEIGHT": 0.1,
  "MEDIATOR_K": 10,
  "MEDIATOR_LAMBDA_IC": 1.0,
  "MEDIATOR_LAMBDA_E": 0.5,
  "GENESIS_BETA": 0.7,
  "GENESIS_LOGIC_MODE": "adaptive_beta",
  "rationale": "Reverting to the initial GENESIS parameters while enabling Inequity Aversion with moderate alpha and beta to encourage fairness and cooperation by penalizing agents for excessive reward disparities.",
  "rationale_kr": "\ucd08\uae30 GENESIS \ud30c\ub77c\ubbf8\ud130\ub85c \ub418\ub3cc\ub9ac\uace0, \uc801\uc808\ud55c \uc54c\ud30c \ubc0f \ubca0\ud0c0 \uac12\uc744 \uc0ac\uc6a9\ud558\uc5ec \ubd88\ud3c9\ub4f1 \ud610\uc624\ub97c \ud65c\uc131\ud654\ud558\uc5ec \ubcf4\uc0c1 \ubd88\uade0\ud615\uc774 \uc2ec\ud55c \uc5d0\uc774\uc804\ud2b8\uc5d0\uac8c \ubd88\uc774\uc775\uc744 \uc90c\uc73c\ub85c\uc368 \uacf5\uc815\uc131\uacfc \ud611\ub825\uc744 \uc7a5\ub824\ud569\ub2c8\ub2e4."
}
  > ğŸš€ GPU Mode: NUM_ENVS=64, BATCH=512, UPDATES=300
  > Compiling JAX graph...
  > Starting loops (JIT ENABLED, GPU)...
  > Testing Prosocial... [Seed=42] [Seed=123] [Seed=7] Done. Coop=0.1170Â±0.0153
  > Testing Individualist... [Seed=42] [Seed=123] [Seed=7] Done. Coop=0.1226Â±0.0094
ğŸ’¾ Results saved to experiments/evolution/current/result.json
  > Simulation finished in 1610.2s
ğŸ§ Critic is analyzing...
ğŸ§ Critic: Report generated. Success=False | S=0.9991 | CR=0.1170Â±0.0153
âŒ [RQ-009] Coop=0.1170 (ëª©í‘œ: 0.5). ê³„ì†...

ğŸ”„ --- [RQ-009] Generation 2 ---
ğŸš¨ Stagnation Detected (Var=0.000045 < 0.0001)
ğŸš¨ Coordinator Intervening: poke
  > Poke: IA_ALPHA â†’ 6.00
  > Level 1 (Poke): IA íŒŒë¼ë¯¸í„° ì¡°ì •
ğŸ§  Theorist is thinking...
ğŸ§  Theorist proposed: {
  "GENESIS_BETA": 1.0,
  "GENESIS_ALPHA": 1.0,
  "GENESIS_LOGIC_MODE": "institutional",
  "IA_ALPHA": 1.0,
  "IA_BETA": 0.1,
  "USE_INEQUITY_AVERSION": true,
  "rationale": "Since high genesis parameters and institutional mode didn't yield good results, let's enable inequity aversion with moderate parameters alongside the institutional mode to see if this combination improves cooperation.",
  "rationale_kr": "\ub192\uc740 \uc81c\ub124\uc2dc\uc2a4 \ud30c\ub77c\ubbf8\ud130\uc640 \uc81c\ub3c4\uc801 \ubaa8\ub4dc\uac00 \uc88b\uc740 \uacb0\uacfc\ub97c \ub0b4\uc9c0 \ubabb\ud588\uc73c\ubbc0\ub85c, \uc81c\ub3c4\uc801 \ubaa8\ub4dc\uc640 \ud568\uaed8 \uc801\ub2f9\ud55c \ud30c\ub77c\ubbf8\ud130\ub85c \ubd88\ud3c9\ub4f1 \ud68c\ud53c\ub97c \ud65c\uc131\ud654\ud558\uc5ec \uc774 \uc870\ud569\uc774 \ud611\ub825\uc744 \ud5a5\uc0c1\uc2dc\ud0a4\ub294\uc9c0 \ud655\uc778\ud574 \ubcf4\uaca0\uc2b5\ub2c8\ub2e4."
}
  > Proposed: Beta=1.0, Alpha=1.0, Mode=institutional, IA=ON
ğŸ› ï¸ Engineer is running simulation...
ğŸ› ï¸ Engineer: Running simulation with config: {
  "ENV_NAME": "cleanup",
  "NUM_AGENTS": 20,
  "ENV_HEIGHT": 36,
  "ENV_WIDTH": 25,
  "MAX_STEPS": 500,
  "NUM_ENVS": 16,
  "NUM_UPDATES": 300,
  "ROLLOUT_LEN": 128,
  "BATCH_SIZE": 2048,
  "LR": 0.0003,
  "HIDDEN_DIM": 128,
  "GAMMA": 0.99,
  "GAE_LAMBDA": 0.95,
  "CLIP_EPS": 0.2,
  "ENTROPY_COEFF": 0.05,
  "VF_COEFF": 0.5,
  "MAX_GRAD_NORM": 0.5,
  "HRL_NUM_NEEDS": 2,
  "HRL_NUM_TASKS": 2,
  "HRL_ALPHA": 1.0,
  "HRL_THRESH_INCREASE": 0.005,
  "HRL_THRESH_DECREASE": 0.05,
  "HRL_INTAKE_VAL": 0.2,
  "REWARD_APPLE": 10.0,
  "COST_BEAM": -1.0,
  "META_BETA": 0.1,
  "META_SURVIVAL_THRESHOLD": -5.0,
  "META_WEALTH_BOOST": 5.0,
  "META_LAMBDA_EMA": 0.9,
  "USE_META_RANKING": true,
  "META_USE_DYNAMIC_LAMBDA": true,
  "GENESIS_MODE": false,
  "GENESIS_BETA_BASE": 10.0,
  "GENESIS_GAMMA": 2.0,
  "GENESIS_ALPHA": 1.0,
  "DASHBOARD_PORT": 4011,
  "USE_INEQUITY_AVERSION": true,
  "IA_ALPHA": 1.0,
  "IA_BETA": 0.1,
  "IA_EMA_LAMBDA": 0.95,
  "SI_WEIGHT": 0.1,
  "MEDIATOR_K": 10,
  "MEDIATOR_LAMBDA_IC": 1.0,
  "MEDIATOR_LAMBDA_E": 0.5,
  "GENESIS_BETA": 1.0,
  "GENESIS_LOGIC_MODE": "institutional",
  "rationale": "Since high genesis parameters and institutional mode didn't yield good results, let's enable inequity aversion with moderate parameters alongside the institutional mode to see if this combination improves cooperation.",
  "rationale_kr": "\ub192\uc740 \uc81c\ub124\uc2dc\uc2a4 \ud30c\ub77c\ubbf8\ud130\uc640 \uc81c\ub3c4\uc801 \ubaa8\ub4dc\uac00 \uc88b\uc740 \uacb0\uacfc\ub97c \ub0b4\uc9c0 \ubabb\ud588\uc73c\ubbc0\ub85c, \uc81c\ub3c4\uc801 \ubaa8\ub4dc\uc640 \ud568\uaed8 \uc801\ub2f9\ud55c \ud30c\ub77c\ubbf8\ud130\ub85c \ubd88\ud3c9\ub4f1 \ud68c\ud53c\ub97c \ud65c\uc131\ud654\ud558\uc5ec \uc774 \uc870\ud569\uc774 \ud611\ub825\uc744 \ud5a5\uc0c1\uc2dc\ud0a4\ub294\uc9c0 \ud655\uc778\ud574 \ubcf4\uaca0\uc2b5\ub2c8\ub2e4."
}
  > ğŸš€ GPU Mode: NUM_ENVS=64, BATCH=512, UPDATES=300
  > Compiling JAX graph...
  > Starting loops (JIT ENABLED, GPU)...
  > Testing Prosocial... [Seed=42] [Seed=123] [Seed=7] Done. Coop=0.1170Â±0.0153
  > Testing Individualist... [Seed=42]